# {{ item.name }} - Generated by Ansible
auto {{ item.name }}
{% if item.dhcp is defined and item.dhcp %}
iface {{ item.name }} inet dhcp
{% if item.nameservers is defined %}
    dns-nameservers {{ item.nameservers | join(' ') }}
{% endif %}
{% if item.search_domains is defined %}
    dns-search {{ item.search_domains | join(' ') }}
{% endif %}
{% else %}
iface {{ item.name }} inet static
{% if item.addresses is defined %}
    address {{ item.addresses[0] | regex_replace('/.*', '') }}
    netmask {{ item.addresses[0] | ansible.utils.ipaddr('netmask') }}
{% endif %}
{% if item.gateway is defined %}
    gateway {{ item.gateway }}
{% endif %}
{% if item.nameservers is defined %}
    dns-nameservers {{ item.nameservers | join(' ') }}
{% endif %}
{% if item.search_domains is defined %}
    dns-search {{ item.search_domains | join(' ') }}
{% endif %}
{% endif %}
{% if item.routes is defined %}

# Additional routes
{% for route in item.routes %}
    up ip route add {{ route.to }} via {{ route.via }}
    down ip route del {{ route.to }} via {{ route.via }}
{% endfor %}
{% endif %}
